@startuml

title ADTNPlus Node Class Diagram

class Node {
	-m_config : Config
	+Node(configFileName : std::string)
	+~Node()
	+restoreBundles(bundleQueue : BundleQueue): void
	+reset() : void
	+start() : void
	+stop() : void
}

abstract class BundleProcessor {
	#m_config : Config
	#m_bundleQueue : BundleQueue
	#m_listeningAppsTable : ListeningAppsTable
	#m_neighbourTable : NeighbourTable
	+BundleProcessor(config : Config, bundleQueue : BundleQueue, listeningAppsTable : ListeningAppsTable, neighbourTable : NeighbourTable)
	+~BundleProcessor()
	-processBundles() : void
	-receiveBundles(): void
	-{abstract}processBundle(bundleContainer : BundleContainer): void
	#dispatch(bundle : Bundle, destinations : std::vector<std::string>) : void
	#forward(bundle : Bundle, nextHop : std::vector<std::string>) : void
	#discard(bundle : Bundle) : void
	#restore(bundle : Bundle) : void
	-{abstract}createBundleContainer(from : Neighbour, bundle : Bundle)
}

class BasicBundleProcessor {
	+BasicBundleProcessor(config : Config, bundleQueue : BundleQueue, listeningAppsTable : ListeningAppsTable, neighbourTable : NeighbourTable)
	+~BasicBundleProcessor()
	-processBundle(bundleContainer : BundleContainer) : void
	-checkDestination(): std::vector<std::string>
	-checkLifetime(): bool
	-checkForward(): std::vector<std::string>
	-createBundleContainer(from : Neighbour, bundle : Bundle)
}

class BundleContainer {
	- m_bundle : Bundle
	- m_from : Neighbour
	+ BundleContainer(from : Neighbour, bundle : Bundle)
	+ getBundle() : Bundle
	+ getFrom() : Neighbour
	+ serialise() : std::string
	+{static}deserialise(data : std::string) : BundleContainer
}

class BundleQueue {
	- m_bundles : std::vector<BundleContainer>
	+ BundleQueue()
	+ ~BundleQueue()
	+ dequeue(): BundleContainer
	+ enqueue(bundleContainer : BundleContainer) : void
}

class Config {
	-m_nodeId : std::string
	-m_nodeAddress : std::string
	-m_nodePort : int
	-m_discoveryAddress : std::string
	-m_discoveryProt : int
	-m_discoveryPeriod : int
	-m_neighbourExpirationTime : int
	-m_neighbourCleanerTime : int
	-m_logFileName : std::string
	-m_logLevel : int
	-{static} NODEID : std::string
	-{static} NODEADDRESS : std::string
	-{static} NODEPORT : int
	-{static} DISCOVERYADDRESS : std::string
	-{static} DISCOVERYPORT : int
	-{static} DISCOVERYPERIOD : int
	-{static} NEIGHBOUREXPIRATIONTIME : int
	-{static} NEIGHBOURCLEANERTIME : int
	-{static} LOGFILENAME : std::string
	-{static} LOGLEVEL : int
	+Config()
	+Config(configFileName : std::string)
	+~Config()
	+getNodeId() : std::string
	+getNodeAddress() : std::string
	+getNodePort() : int
	+getDiscoveryAddress() : std::string
	+getDiscoveryPort() : int
	+getDiscoveryPeriod(): int
	+getNeighbourExpirationTime():int
	+getNeighbourCLeanerTime():int
	+getLogFileName() : std::string
	+getLogLevel():int
}

class ConfigLoader {
	-m_reader : INIReader
	+load(configFileName : std::string ) : void
	+ConfigLoader()
	+~ConfigLoader()
}

Config ..> ConfigLoader : <i>uses</i> 
BundleQueue --> "0..n\n<i>m_bundles</i>" BundleContainer
Node ..> BundleProcessor : <i>uses</i>


Node --> "<i>m_config</i>" Config
BundleProcessor --> "<i>m_bundleQueue</i>" BundleQueue
BundleProcessor <|-- BasicBundleProcessor
@enduml